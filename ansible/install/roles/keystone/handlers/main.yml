---
#
# Keystone handlers
#

#
# Restart keystone when in httpd
#

- name: restart httpd
  service: name=httpd state=restarted
  when: "connmon and 'httpd' == '{{ keystone_deployment }}'"
  ignore_errors: true

#
# Restart keystone when in eventlet
#

- name: unmanage keystone
  command: pcs resource unmanage openstack-keystone
  when: "connmon and 'eventlet' == '{{ keystone_deployment }}'"
  ignore_errors: true

- name: restart keystone
  service: name=openstack-keystone state=restarted
  when: "connmon and 'eventlet' == '{{ keystone_deployment }}'"

- name: manage keystone
  command: pcs resource manage openstack-keystone
  when: "connmon and 'eventlet' == '{{ keystone_deployment }}'"
  ignore_errors: true

- name: cleanup keystone
  command: pcs resource cleanup openstack-keystone
  when: "connmon and 'eventlet' == '{{ keystone_deployment }}'"
  ignore_errors: true
